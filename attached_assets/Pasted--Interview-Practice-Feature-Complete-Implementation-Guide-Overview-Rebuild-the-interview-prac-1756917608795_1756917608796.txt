# Interview Practice Feature - Complete Implementation Guide

## Overview
Rebuild the interview practice feature from scratch with a simple, robust architecture.

## Core Requirements

### Question Bank System
- **Base Questions**: 100 pre-loaded general interview questions
- **Role-Specific Questions**: 50 questions generated dynamically based on user input (role + band)
- **Total**: 150 questions per user session

### User Flow
1. User inputs role name and pay band/grade
2. System generates 50 role-specific questions via ChatGPT
3. User starts practice session
4. 5 random questions selected from 150-question pool
5. 10-minute time limit for all 5 questions
6. Henry the Helper (ChatGPT) provides feedback and scoring
7. Results saved to user's interview practice card

## Implementation Structure

### 1. Database Schema

```sql
-- Users table (assuming exists)
CREATE TABLE users (
    id PRIMARY KEY,
    username VARCHAR(255)
);

-- Interview sessions
CREATE TABLE interview_sessions (
    id PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    role_name VARCHAR(255),
    pay_band VARCHAR(100),
    score INTEGER, -- Out of 10
    feedback TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Questions for each session
CREATE TABLE session_questions (
    id PRIMARY KEY,
    session_id INTEGER REFERENCES interview_sessions(id),
    question_text TEXT,
    user_answer TEXT,
    individual_feedback TEXT
);

-- Base questions (pre-loaded)
CREATE TABLE base_questions (
    id PRIMARY KEY,
    question_text TEXT,
    category VARCHAR(100)
);
```

### 2. Backend API Endpoints

#### Generate Role-Specific Questions
```
POST /api/generate-questions
Body: {
    "role": "Software Engineer",
    "band": "Senior Level"
}
Response: {
    "questions": ["question1", "question2", ...], // 50 questions
    "session_id": "uuid"
}
```

#### Start Interview Session
```
POST /api/interview/start
Body: {
    "session_id": "uuid"
}
Response: {
    "questions": ["q1", "q2", "q3", "q4", "q5"], // 5 random from 150
    "time_limit": 600 // 10 minutes in seconds
}
```

#### Submit Answers
```
POST /api/interview/submit
Body: {
    "session_id": "uuid",
    "answers": [
        {"question": "q1", "answer": "user answer 1"},
        {"question": "q2", "answer": "user answer 2"},
        // ... all 5
    ]
}
Response: {
    "feedback": "Overall feedback from Henry",
    "individual_feedback": [
        {"question": "q1", "feedback": "specific feedback"},
        // ...
    ],
    "score": 8
}
```

#### Get User History
```
GET /api/interview/history/:user_id
Response: {
    "sessions": [
        {
            "date": "2025-01-15",
            "role": "Software Engineer",
            "score": 8,
            "feedback": "..."
        }
    ]
}
```

### 3. ChatGPT Integration

#### Question Generation Prompt
```
Role: Interview Question Generator
Task: Generate exactly 50 interview questions for the following role and level:

Role: {role_name}
Level/Band: {pay_band}

Requirements:
- Questions should be specific to this role and seniority level
- Mix of technical, behavioral, and situational questions
- Appropriate difficulty for the specified band/level
- Return as a simple JSON array of strings

Format: ["question1", "question2", ..., "question50"]
```

#### Feedback Generation Prompt
```
Role: Henry the Helper - Interview Coach
Task: Review interview practice session and provide feedback

Role Applied For: {role_name}
Level: {pay_band}

Questions and Answers:
1. Q: {question1}
   A: {answer1}

2. Q: {question2}
   A: {answer2}

[... continue for all 5]

Please provide:
1. Individual feedback for each answer (2-3 sentences each)
2. Overall performance summary
3. Score out of 10
4. 2-3 key improvement suggestions

Format your response as JSON:
{
    "individual_feedback": [
        {"question_num": 1, "feedback": "..."},
        {"question_num": 2, "feedback": "..."},
        ...
    ],
    "overall_feedback": "...",
    "score": X,
    "improvement_tips": ["tip1", "tip2", "tip3"]
}
```

### 4. Frontend Components

#### Interview Setup Component
```javascript
// InterviewSetup.jsx
const InterviewSetup = () => {
    const [role, setRole] = useState('');
    const [band, setBand] = useState('');
    const [loading, setLoading] = useState(false);
    
    const startInterview = async () => {
        setLoading(true);
        try {
            // Generate questions
            const response = await fetch('/api/generate-questions', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({role, band})
            });
            const data = await response.json();
            
            // Navigate to interview session
            navigate(`/interview/${data.session_id}`);
        } catch (error) {
            console.error('Failed to start interview:', error);
        }
        setLoading(false);
    };
    
    return (
        <div>
            <input 
                placeholder="Enter role (e.g., Software Engineer)"
                value={role}
                onChange={(e) => setRole(e.target.value)}
            />
            <input 
                placeholder="Enter band/level (e.g., Senior)"
                value={band}
                onChange={(e) => setBand(e.target.value)}
            />
            <button onClick={startInterview} disabled={loading}>
                {loading ? 'Preparing Interview...' : 'Start Practice'}
            </button>
        </div>
    );
};
```

#### Interview Session Component
```javascript
// InterviewSession.jsx
const InterviewSession = () => {
    const [questions, setQuestions] = useState([]);
    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
    const [answers, setAnswers] = useState({});
    const [timeLeft, setTimeLeft] = useState(600); // 10 minutes
    const [sessionStarted, setSessionStarted] = useState(false);
    
    useEffect(() => {
        if (sessionStarted && timeLeft > 0) {
            const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
            return () => clearTimeout(timer);
        } else if (timeLeft === 0) {
            submitInterview();
        }
    }, [timeLeft, sessionStarted]);
    
    const submitInterview = async () => {
        // Submit answers for feedback
        const response = await fetch('/api/interview/submit', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                session_id: sessionId,
                answers: Object.entries(answers).map(([question, answer]) => ({
                    question, answer
                }))
            })
        });
        
        const feedback = await response.json();
        navigate(`/interview/results/${sessionId}`, {state: feedback});
    };
    
    // Component render logic...
};
```

### 5. Implementation Steps

#### Phase 1: Setup & Database
1. Create database tables
2. Load 100 base questions into `base_questions` table
3. Set up basic API routes

#### Phase 2: Question Generation
1. Implement ChatGPT integration for role-specific questions
2. Create question generation endpoint
3. Test with various roles and bands

#### Phase 3: Interview Session
1. Build session management system
2. Implement 5-question selection logic (random from 150)
3. Create timer functionality
4. Build answer submission system

#### Phase 4: Feedback System
1. Implement Henry the Helper feedback generation
2. Create scoring system
3. Build results display
4. Implement session history storage

#### Phase 5: Frontend
1. Build interview setup form
2. Create interview session interface
3. Develop results/feedback display
4. Implement history/progress tracking

### 6. Base Questions (Sample - implement all 100)

```javascript
const baseQuestions = [
    // NHS values & the 6Cs
    "What do the NHS 6Cs mean to you in everyday work?",
    "Which of the 6Cs do you naturally lead with, and which do you actively develop?",
    "Describe a time you showed Care that improved someone's experience.",
    "How do you demonstrate Compassion when someone is upset or anxious?",
    "What does Competence look like day-to-day in your role?",
    "Give an example of clear Communication preventing a problem.",
    "When have you shown Courage to raise a concern or challenge poor practice?",
    "How do you show Commitment to continuous improvement?",
    "How do you balance compassion with maintaining professional boundaries?",
    "How do you ensure your communication is inclusive and accessible?",
    "Tell us about a time you advocated for a patient/service user.",
    "How do you respond when you notice a value being compromised?",
    "What steps do you take to embed the 6Cs in team routines?",
    "How do you handle value conflicts between speed, safety, and kindness?",
    "Describe a small action that has a big impact on dignity and respect.",
    "How do you keep compassion high on a busy or stressful day?",
    "How do you evidence your competence to yourself and others?",
    "When have you used courage to admit a mistake and learn from it?",
    "What commitments have you made to your own professional growth this year?",
    "How do you align your daily work with the NHS Constitution and local Trust values?",
    
    // Patient experience & communication
    "How do you make a good first impression in the first 30 seconds?",
    "How do you explain processes or delays in a way that maintains trust?",
    "What strategies help you communicate with someone who has limited English?",
    "How do you tailor your communication for children or older adults?",
    "How do you handle a complaint at the point of care?",
    "Describe a time you turned negative feedback into a better experience.",
    "How do you involve families/carers appropriately in conversations?",
    "How do you confirm understanding without sounding patronising?",
    "What do you do if someone refuses care or support you believe is needed?",
    "How do you de-escalate frustration or anger respectfully?",
    "How do you ensure privacy during sensitive conversations?",
    "How do you handle giving simple information when you don't know the full answer?",
    "What does good written communication look like in your paperwork/messages?",
    "How do you use active listening to pick up what isn't being said?",
    "How do you close an interaction so the person feels informed and valued?",
    
    // Teamwork & collaboration
    "What does being a good team member mean to you?",
    "Describe a time you supported a colleague who was struggling.",
    "How do you handle disagreements within the team?",
    "How do you ensure smooth handovers between shifts or teams?",
    "When have you led informally without a title?",
    "How do you share knowledge so others can succeed without relying on you?",
    "What do you do to build trust with new team members quickly?",
    "How do you adapt your style when working with different professions?",
    "Describe a time you asked for help early and avoided a bigger issue.",
    "How do you contribute to a positive, inclusive team culture?",
    
    // Safety, quality & improvement
    "What does 'patient safety first' mean in practical terms?",
    "How do you raise a safety concern promptly and appropriately?",
    "Tell us about a small improvement you implemented that stuck.",
    "How do you prioritise tasks when everything feels urgent?",
    "How do you use checklists or prompts to reduce errors?",
    "Describe how you learn from incidents or near-misses.",
    "What data or feedback do you find most useful to improve services?",
    "How do you balance efficiency with thoroughness?",
    "How do you ensure consistency on busy days or with bank/agency staff?",
    "How do you keep yourself and others accountable for quality?",
    
    // Equality, diversity & inclusion (EDI)
    "What does inclusive care mean to you?",
    "How do you make reasonable adjustments for individuals' needs?",
    "Describe a time you challenged bias or stereotyping.",
    "How do you ensure your language is culturally sensitive and respectful?",
    "How do you create a welcoming environment for diverse backgrounds?",
    "How do you handle micro-aggressions or subtle exclusion?",
    "What steps do you take to learn about communities you serve?",
    "How do you ensure fairness in access, information, and support?",
    "Describe a time patient feedback helped you improve inclusivity.",
    "How do you support colleagues from under-represented groups?",
    
    // Professionalism & boundaries
    "What does professionalism look like when nobody is watching?",
    "How do you maintain boundaries while being friendly and supportive?",
    "How do you manage conflicts of interest or dual relationships?",
    "How do you respond if a colleague asks you to 'bend the rules'?",
    "What steps do you take to be punctual, reliable, and prepared?",
    "How do you handle social media use in line with organisational policy?",
    "How do you deal with confidential information in public spaces?",
    "What would you do if someone offered you an inappropriate gift?",
    
    // Confidentiality & information governance
    "How do you protect personal information day-to-day?",
    "How do you verify identity before sharing any information?",
    "What do you do if you receive information you're not meant to have?",
    "How do you handle requests for information from family or friends?",
    "How do you minimise risks when using email or messaging platforms?",
    "How do you store and dispose of notes securely?",
    "How do you report an information governance concern promptly?",
    
    // Handling pressure & resilience
    "How do you look after your wellbeing so you can care for others?",
    "Describe a time you stayed calm and effective under pressure.",
    "How do you recognise early signs of stress in yourself?",
    "What supports or routines keep you resilient over the long term?",
    "How do you communicate when your workload becomes unsafe?",
    "How do you reset after a difficult interaction or shift?",
    "How do you maintain high standards when fatigued or short-staffed?",
    
    // Learning & development
    "What have you learned recently that changed your practice?",
    "How do you seek feedback, and what do you do with it?",
    "How do you set meaningful development goals for yourself?",
    "Describe how you help others learn on the job.",
    "How do you evidence learning for appraisals or portfolios?",
    
    // Working in the NHS (general)
    "What attracts you to working in the NHS specifically?",
    "How do you live the NHS Constitution values in everyday tasks?",
    "How do you prepare for shift work and continuity of care?",
    "How do you handle competing priorities from different stakeholders?",
    "What does 'duty of candour' mean in your words, and how do you apply it?",
    "How would you approach raising concerns (e.g., via line manager or Freedom to Speak Up)?",
    "How do you contribute to a culture of kindness and psychological safety?",
    "Where do you see yourself adding value in our team over the next 12 months?"
];
```

### 7. Key Features

#### Timer System
- 10-minute countdown for all 5 questions
- Auto-submit when time expires
- Visual timer display

#### Progress Tracking
- Save all interview sessions
- Display score history
- Show improvement over time

#### Responsive Design
- Works on desktop and mobile
- Clean, simple interface
- Focus on user experience

## Testing Strategy

1. **Unit Tests**: Test individual functions
2. **Integration Tests**: Test API endpoints
3. **User Testing**: Test complete user journey
4. **Load Testing**: Test with multiple concurrent users

## Deployment Checklist

- [ ] Database schema created
- [ ] Base questions loaded
- [ ] ChatGPT API keys configured
- [ ] All endpoints tested
- [ ] Frontend components built
- [ ] Timer functionality verified
- [ ] Feedback system working
- [ ] User authentication integrated
- [ ] Error handling implemented
- [ ] Mobile responsive design confirmed